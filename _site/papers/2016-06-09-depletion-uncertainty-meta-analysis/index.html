<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
<title>Existentially, technology: Comparison of Pressurized Water Reactor Depletion Code Validation Approaches</title>

<meta property="description" itemprop="description" content=""/>

<link rel="canonical" href="https://existentially-tech.netlify.app/papers/2016-06-09-depletion-uncertainty-meta-analysis/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../images/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2016-06-09"/>
<meta property="article:created" itemprop="dateCreated" content="2016-06-09"/>
<meta name="article:author" content="Amrit Patel"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Existentially, technology: Comparison of Pressurized Water Reactor Depletion Code Validation Approaches"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content=""/>
<meta property="og:url" content="https://existentially-tech.netlify.app/papers/2016-06-09-depletion-uncertainty-meta-analysis/"/>
<meta property="og:image" content="https://existentially-tech.netlify.app/papers/2016-06-09-depletion-uncertainty-meta-analysis/depletion-uncertainty-meta-analysis_files/figure-html5/unnamed-chunk-1-1.png"/>
<meta property="og:image:width" content="1248"/>
<meta property="og:image:height" content="768"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Existentially, technology"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Existentially, technology: Comparison of Pressurized Water Reactor Depletion Code Validation Approaches"/>
<meta property="twitter:description" content=""/>
<meta property="twitter:url" content="https://existentially-tech.netlify.app/papers/2016-06-09-depletion-uncertainty-meta-analysis/"/>
<meta property="twitter:image" content="https://existentially-tech.netlify.app/papers/2016-06-09-depletion-uncertainty-meta-analysis/depletion-uncertainty-meta-analysis_files/figure-html5/unnamed-chunk-1-1.png"/>
<meta property="twitter:image:width" content="1248"/>
<meta property="twitter:image:height" content="768"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Existentially, technology: Comparison of Pressurized Water Reactor Depletion Code Validation Approaches"/>
<meta name="citation_fulltext_html_url" content="https://existentially-tech.netlify.app/papers/2016-06-09-depletion-uncertainty-meta-analysis/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2016/06/09"/>
<meta name="citation_publication_date" content="2016/06/09"/>
<meta name="citation_author" content="Amrit Patel"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=An approach for validating actinide and fission product burnup credit criticality safety analyses - isotopic composition predictions;citation_publication_date=2012;citation_publisher=ORNL;citation_author=G Radulescu;citation_author=I. C. Gauld;citation_author=G. Ilas;citation_author=J. C. Wagner"/>
  <meta name="citation_reference" content="citation_title=Benchmarks for quantifying fuel reactivity depletion uncertainty;citation_publication_date=2011;citation_publisher=Electric Power Research Institute, Palo Alto, CA;citation_author=K. Smith;citation_author=S. Tarves;citation_author=T. Bahadir;citation_author=R. Ferrer"/>
  <meta name="citation_reference" content="citation_title=Utilization of the EPRI depletion benchmarks for burnup credit validation;citation_publication_date=2012;citation_publisher=Electric Power Research Institute, Palo Alto, CA;citation_author=Dale Lancaster"/>
  <meta name="citation_reference" content="citation_title=tolerance: An R package for estimating tolerance intervals;citation_publication_date=2010;citation_volume=36;citation_author=Derek S. Young"/>
  <meta name="citation_reference" content="citation_title=R: A language and environment for statistical computing;citation_publication_date=2015;citation_publisher=R Foundation for Statistical Computing;citation_author=R: A language and environment for statistical computing"/>
  <meta name="citation_reference" content="citation_title=NIST/SEMATECH e-handbook of statistical methods;citation_publication_date=2013;citation_publisher=NIST/SEMATECH;citation_author=Mary Natrella"/>
  <meta name="citation_reference" content="citation_title=SCALE: A comprehensive modeling and simulation suite for nuclear safety analysis and design;citation_publication_date=2011;citation_publisher=ORNL;citation_number=ORNL/TM-2005/39;citation_author= ORNL"/>
  <meta name="citation_reference" content="citation_title=Strategies for application of isotopic uncertainties in burnup credit;citation_publication_date=2003;citation_author=IC Gauld"/>
  <meta name="citation_reference" content="citation_title=ANSI/ANS-8.27-2015, burnup credit for LWR fuel;citation_publication_date=2015;citation_publisher=American Nuclear Society;citation_number=ANSI/ANS-8.27;citation_author= ANS"/>
  <meta name="citation_reference" content="citation_title=Tolerance intervals for linear regression;citation_publication_date=1951;citation_author=W. Allen Wallis"/>
  <meta name="citation_reference" content="citation_title=Tolerance intervals in a heteroscedastic linear regression context with applications to aerospace equipment surveillance;citation_publication_date=2010;citation_publisher=Hindawi Publishing Corporation;citation_volume=2009;citation_doi=10.1155/2009/126283;citation_author=Janet Myhre;citation_author=Daniel R Jeske;citation_author=Michael Rennie;citation_author=Yingtao Bi"/>
  <meta name="citation_reference" content="citation_title=Tolerance interval — wikipedia, the free encyclopedia;citation_publication_date=2016;citation_author= Wikipedia"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["creative_commons","title","description","author","date","output","bibliography","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["Comparison of Pressurized Water Reactor Depletion Code Validation Approaches"]},{"type":"character","attributes":{},"value":[""]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Amrit Patel"]},{"type":"character","attributes":{},"value":["0000-0003-3911-6281"]}]}]},{"type":"character","attributes":{},"value":["06-09-2016"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","code_folding","self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["metaAnalysis.bib"]},{"type":"character","attributes":{},"value":["https://existentially-tech.netlify.app/papers/2016-06-09-depletion-uncertainty-meta-analysis/"]},{"type":"character","attributes":{},"value":["https://existentially-tech.netlify.app/papers/2016-06-09-depletion-uncertainty-meta-analysis/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["data/7108DDdata.csv","data/EPRIuncData.csv","data/modFit.Rdata","data/sfpCritUncAnalysis.Rdata","depletion-uncertainty-meta-analysis_files/anchor-4.2.2/anchor.min.js","depletion-uncertainty-meta-analysis_files/bowser-1.9.3/bowser.min.js","depletion-uncertainty-meta-analysis_files/distill-2.2.21/template.v2.js","depletion-uncertainty-meta-analysis_files/figure-html5/unnamed-chunk-1-1.png","depletion-uncertainty-meta-analysis_files/figure-html5/unnamed-chunk-2-1.png","depletion-uncertainty-meta-analysis_files/figure-html5/unnamed-chunk-3-1.png","depletion-uncertainty-meta-analysis_files/header-attrs-2.6.6/header-attrs.js","depletion-uncertainty-meta-analysis_files/jquery-1.11.3/jquery.min.js","depletion-uncertainty-meta-analysis_files/popper-2.6.0/popper.min.js","depletion-uncertainty-meta-analysis_files/tippy-6.2.7/tippy-bundle.umd.min.js","depletion-uncertainty-meta-analysis_files/tippy-6.2.7/tippy-light-border.css","depletion-uncertainty-meta-analysis_files/tippy-6.2.7/tippy.css","depletion-uncertainty-meta-analysis_files/tippy-6.2.7/tippy.umd.min.js","depletion-uncertainty-meta-analysis_files/webcomponents-2.0.0/webcomponents.js","metaAnalysis.bib","scripts/k1correctionEPRIstat.R"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.6.6/header-attrs.js"></script>
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Comparison of Pressurized Water Reactor Depletion Code Validation Approaches","description":"","authors":[{"author":"Amrit Patel","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":"0000-0003-3911-6281"}],"publishedDate":"2016-06-09T00:00:00.000+00:00","citationText":"Patel, 2016"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">Existentially, technology</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../papers.html">Papers</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
About
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../../about.html">Me</a>
<a href="../../cv.html">CV</a>
</div>
</div>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Comparison of Pressurized Water Reactor Depletion Code Validation Approaches</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  Amrit Patel  
  
<br/>06-09-2016
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction">Introduction</a>
<ul>
<li><a href="#kopp-5">Kopp 5%</a></li>
<li><a href="#monte-carlo-uncertainty-sampling">Monte Carlo Uncertainty Sampling</a></li>
<li><a href="#direct-difference">Direct Difference</a></li>
<li><a href="#electric-power-research-institute-reactivity-benchmarks">Electric Power Research Institute Reactivity Benchmarks</a></li>
</ul></li>
<li><a href="#analysis">Analysis</a>
<ul>
<li><a href="#data-sources">Data Sources</a></li>
<li><a href="#modeling">Modeling</a></li>
<li><a href="#comparison-of-independent-9595-depletion-code-bias-plus-uncertainty-characterizations">Comparison of Independent 95/95 Depletion Code Bias Plus Uncertainty Characterizations</a></li>
</ul></li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#appendix-a-determination-of-9550-tolerance-interval-penalty-factor-to-apply-to-epri-calculated-regression-uncertainty">Appendix A: Determination of 95/50 Tolerance Interval Penalty Factor to Apply to EPRI-Calculated Regression Uncertainty</a></li>
</ul>
</nav>
</div>
<h2 id="introduction">Introduction</h2>
<p>In this analysis, 5 depletion code validation approaches are compared side-by-side. Each approach is briefly described, the statistical approaches used in this analysis are explained, and finally the resultant depletion uncertainty versus burnup characterizations are compared visually and discussed. Finally, some conclusions are made with implications for future spent fuel pool (SFP) criticality safety analyses (CSAs) that will be submitted to the NRC for review and approval.</p>
<h3 id="kopp-5">Kopp 5%</h3>
<p>Since approximately 1998, NRC commercial power plant licensees have adopted the “Kopp 5%” approach in lieu of a formal depletion code validation. This has been documented in several recently issued SFP CSA safety evaluation reports and is explained further in NRC internal guidance document DSS-ISG-2010-01. The results of this approach are practically regarded as a “depletion uncertainty” in SFP CSAs submitted to the NRC to satisfy 10 CFR 50.68(b)(4) requirements. Consequently, for simplicity, the uncertainty arising from (or attributed to) the use of depletion codes to predict spent fuel isotopics, in terms of reactivity, will be reffered to as “depletion uncertainty” for the remainder of this report.</p>
<p>Fundamentally, the Kopp 5% approach is based on reactor design code uncertainties (e.g. lattice physics depletion codes – or depletion codes – in conjunction with reactor simulator codes). All NRC power plant licensees are required to use only reactor design codes that have been specifically approved for use by the NRC at the respective licensee facility. It has been observed that implementation of these codes for reactor core and cycle design generally result in various relevant figures of merit well within 5% of measured values irrespective of reactor core design code type and licensee.</p>
<p>Consequently, most commercially licensed light water reactor licensees use the Kopp 5% approach since they already use previously licensed reactor design codes to perform depletion calculations in support of other design basis calculations (e.g. core design and transient analyses).</p>
<p>The major pitfall with this method is that it is <em>not</em> a generally applicable method and it is ultimately based on the observation that depletion codes in conjunction with reactor simulator codes can generally predict certain measured values within 5%. Because these predictions are generally within 5% of measured values by a large margin, this approach has been considered to be conservative. However, the relationship between the isotopic prediction accuracy of the depletion and simulator codes has not been formally tied to the Kopp 5% approach in terms of reactivity. Rather, it is implied, for example, that a relative assembly power prediction accuracy bounded by 5% directly translates into SFP reactivity prediction accuracy within 5%. The implication that this is true is the engineering judgment being made. The main goal of this study is to attempt to qualify this engineering judgment based on comparison to formal validation approaches.</p>
<h3 id="monte-carlo-uncertainty-sampling">Monte Carlo Uncertainty Sampling</h3>
<p>The Monte Carlo uncertainty sampling method (MC USM) is described in detail in NUREG/CR-6811, “Strategies for Application of Isotopic Uncertainties in Burnup Credit” <span class="citation" data-cites="gauld2003strategies">(<a href="#ref-gauld2003strategies" role="doc-biblioref">Gauld 2003</a>)</span> and is implemented for a typical SFP storage configuration in NUREG/CR-7108, “An Approach for Validating Actinide and Fission Product Burnup Credit Criticality Safety Analyses - Isotopic Composition Predictions” <span class="citation" data-cites="cr7108">(<a href="#ref-cr7108" role="doc-biblioref">Radulescu et al. 2012</a>)</span>. The intent of the NUREG/CR-7108 research effort was to enable the creation of guidance that would allow NRC licensees to perform formal, technically-justified, depletion code validation analyses.</p>
<p>NUREG/CR-7108 states, “[The MC USM] is used to represent the effects of nuclide concentration uncertainty on k-effective values by sampling isotopic concentrations from uncertainty distributions developed from experimental data.” Essentially, distributions of measured-to-calculated (M/C) isotopic concentrations are formed for 28 nuclides<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> – these are important major and minor actinides and fission products. The measurements are derived from radiochemical assays (RCA) and samples are available at various burnups between 7 and 61 gigawatt-days per metric ton uranium (GWd/MTU). The RCA data is split up into a total of three burnup bins that have been defined using trending analysis. Burnup-dependent M/C distributions are formed for each of the major and minor actinides while the fission product data is lumped into a single bin over the range of RCA data burnups.</p>
<p>As part of the MC USM approach, depletion calculations are performed, to the various burnups of interest, using the TRITON two-dimensional (2-D) depletion code with nuclear cross-section data from Version 7.0 of the Evaluated Nuclear Data File maintained by Brookhaven National Laboratory (ENDF/B-VII.0); TRITON is part of the SCALE, Version 6.1 computer code package (SCALE 6.1) <span class="citation" data-cites="scale61">(<a href="#ref-scale61" role="doc-biblioref">ORNL 2011</a>)</span>.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> Isotopics from these depletion calculations are used in subsequent criticality calculations and these criticality calculations serve as the reference calculations that determine the burnup-dependent reference k-effective values for the analyzed SFP configuration.</p>
<p>Between 250-500 criticality calculations are then performed for each chosen burnup point used in establishing the depletion uncertainty versus burnup relationship. Each criticality calculation samples all 28 of the pre-defined burnup-dependent M/C distributions. NUREG/CR-7108 uses 7-9 burnup points to establish the depletion uncertainty versus burnup relationship, thus somewhere between 1750 and 4500 criticality calculations are needed with the MC USM approach.</p>
<p>Estimates of bias can then be formed based on calculating the difference between the reference k-effective calculations (i.e. without using any sampled M/C values to replace as-calculated values) and the simple average of the 250-500 criticality calculation k-effective values based on sampling the M/C distributions. Application of a statistical tolerance factor then allows for determination of uncertainty at a 95% probability, 95% confidence (95/95) level. More specifically, this is the uncertainty that would cover 95% of all k-effective values possible for the given configuration with 95% confidence based on the data available.</p>
<p>It was seen that a positive bias was determined over all burnup indicating that the SCALE 6.1 TRITON depletion code used in the analysis tends to overpredict spent fuel reactivity; these positive biases are not typically credited in SFP CSAs. Consequently, only the bias uncertainty remains and is characterized as the 95/95 depletion uncertainty.</p>
<p>The major pitfall with this method is that the experimental procedure is associated with relatively high RCA measurement uncertainties and operational history uncertainties that likely compound with increasing burnup.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> These high experimental procedure uncertainties manifest as statistical noise. This noise is separate from the true variance that is sought, which is associated solely with the depletion code. Consequently, estimates of 95/95 depletion uncertainty from the MC USM will be conservatively inflated.</p>
<h3 id="direct-difference">Direct Difference</h3>
<p>The direct difference approach, also described in detail in NUREG/CR-6811, was also implemented in NUREG/CR-7108 and makes use of the same raw measurement data that the MC USM uses. However, the direct difference approach is less rigorous compared to the MC USM and is less computationally expensive as it does not require thousands of criticality calculations, but only a hundred or so.</p>
<p>The direct difference approach does not require the formation of M/C distributions because no sampling is done. Instead, RCA measurements are used directly in criticality models. That is, a vector of 28 nuclides (plus oxygen) corresponding to a RCA measurement from a single position within an assembly at a given burnup are used to represent the fuel composition for a given criticality model. Separate cases are created for each RCA datum corresponding to a single burnup measurement and nuclide vector from which a k-effective is calculated using the same criticality code which is part of the overall k-effective validation procedure. The k-effective values from these calculations are then differenced with reference k-effective values from respective criticality calculations where measurements were not used in place of the as-calculated values. A fit of the direct difference data is then determined as a function of burnup – this can be used to determine the depletion code prediction bias as a function of burnup. A statistical tolerance interval for regression can then be calculated to determine an appropriate bias uncertainty. It should be noted that the bias, and more particularly, the bias uncertainty is <em>very</em> sensitive to the data fitting procedure and the statistical tolerance interval generation procedure, therefore care must be taken and an appropriate technical rationale must be given. One common tolerance interval for regression is the prediction interval. This is a 95/50 tolerance interval and allows for the interpretation that one is 50% confident that at least 95% of the data is within the interval. It should be noted that the SFP criticality regulatory requirement in 10 CFR 50.68(b)(4) requires a 95/95 tolerance interval.</p>
<p>As with the MC USM, the direct difference method shows a positive bias over all burnup.</p>
<p>An illustrative example is provided in NUREG/CR-7108 implementing the direct difference approach for an unpoisoned SFP storage rack application and concludes that:</p>
<blockquote>
<p>[The comparison of the Monte Carlo uncertainty sampling approach with the direct difference approach] provides some limited evidence that the two different methods can produce similar results, thereby providing limited reassurance in the Monte Carlo approach for uncertainty propagation. However, further work with the direct-difference method, including additional comparisons and fully addressing the considerations described below, is needed prior to drawing firm conclusions.</p>
</blockquote>
<p>The major pitfall with this method is the same as that for the MC USM; that is, the relatively large experimental procedure uncertainties.</p>
<h3 id="electric-power-research-institute-reactivity-benchmarks">Electric Power Research Institute Reactivity Benchmarks</h3>
<p>Two reports were created by the Electric Power Research Institute (EPRI) detailing methods for validating pressurized water reactor (PWR) criticality calculations that credit depleted fuel in SFP storage configurations. EPRI Report 1022909, “Benchmarks for Quantifying Fuel Reactivity Depletion Uncertainty” (i.e. the “EPRI benchmark report”), details the use of flux map data to infer the uncertainty associated with depletion reactivity calculations using Studsvik Scandpower’s CASMO and SIMULATE-3 reactor analysis tools <span class="citation" data-cites="epriTOPa2011">(<a href="#ref-epriTOPa2011" role="doc-biblioref">Smith et al. 2011</a>)</span>. EPRI Report 1025203, “Utilization of the EPRI Depletion Benchmarks for Burnup Credit Validation” (i.e. the “EPRI utilization report”), relates to the benchmark report by providing 11 calculational PWR depletion benchmarks allowing for determination of an application-specific depletion reactivity bias adjustment <span class="citation" data-cites="epriTOPb2012">(<a href="#ref-epriTOPb2012" role="doc-biblioref">Lancaster 2012</a>)</span>.</p>
<p>EPRI’s total uncertainty estimate does not include a 95/95-based regression fit uncertainty in their analysis. Instead, EPRI qualitatively discounts high variance data by explaining that the high variance is caused by “measurement uncertainty” not associated with true depletion code uncertainty. The NRC acknowledges that this could be true, but formal quantitative justification for this claim must be provided.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> Consequently, the depletion uncertainty is much smaller than any of the other characterizations.</p>
<p>It is interesting to note that, in Section 5 of the EPRI utilization report, an example validation analysis is presented based on SCALE6.1/TRITON<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> (using ENDF/B-VII data) as the depletion code. Table 5-2, “Bias for the Reactivity Decrement with 100-Hour Cooling Using SCALE 6.1 and the ENDF/B-VII Cross-section Library,” shows the reactivity differences between SCALE6.1/TRITON and CASMO-5 predictions for a matrix of 66 cases (varying burnups between 10 and 60 GWd/MTU). The maximum bias is seen to be 260 percent millirho (pcm) indicating excellent agreement between SCALE6.1/TRITON and CASMO-5 depletion codes for a range of cases and fuel characteristics. This excellent agreement is useful to keep in mind when comparing the EPRI benchmarking effort for the SCALE 6.1 TRITON depletion code with the two NUREG/CR-7108 benchmarking efforts also performed with the SCALE 6.1 TRITON depletion code. That is, it is expected that performing a MC USM or direct difference approach to validate SCALE 6.1 TRITON will result in very similar depletion uncertainty versus burnup characterization when using the EPRI validation approach with either CASMO-5 or SCALE 6.1 TRITON <em>if</em> measurement uncertainties are small relative to depletion code uncertainty or if measurement uncertainties are similar between the two validation approaches.</p>
<p>Like with the NUREG/CR-7108 approaches, the major pitfall with this method is that the experimental procedure is associated with relatively high measurement uncertainties. In this case the measurement uncertainty is based on the chosen depletion uncertainty inferencing method as EPRI notes in the 9th bullet of Section 7.1, “Interpretation of Data,” of the EPRI benchmark report. Like with the two NUREG/CR-7108 approaches, these measurement uncertainties are confounded with the uncertainty that comes solely from the depletion code.</p>
<h2 id="analysis">Analysis</h2>
<p>The objective of the following analysis is to see whether or not the various depletion code validation methods produce similar 95/95-based characterizations of depletion uncertainty as a function of burnup for typical SFP storage configurations. For the Kopp 5%, MC USM, and the EPRI-conducted validation approach, “bounding” values of depletion uncertainty were determined without a regression analysis step because a regression analysis was not performed from which a regression fit uncertainty was characterized. It should be noted that if a regression anlaysis is being performed, a regression analysis step that includes a 95/95 characterization of uncertainty (or similar) must be used for compliance with 10 CFR 50.68(b)(4). Since the EPRI-conducted validation approach did not include a 95/95 characterization of uncertainty (or similar) as part of their data analysis, the EPRI validation approach was adjusted by the NRC staff to account for the regression analysis uncertainty for consistency with 10 CFR 50.68(b)(4). A 95/95-based regession analysis uncertainty was also characterized for the NUREG/CR-7108 direct difference validation approach since it also relies on regression analysis.</p>
<h3 id="data-sources">Data Sources</h3>
<p>The direct difference data was taken directly from Table 6.3, “Unpoisoned PWR SFP storage rack <span class="math inline">\(\Delta k_{eff}\)</span> obtained with measured and calculated nuclide concentrations” in NUREG/CR-7108. The criticality models are based on a representative PWR SFP storage rack model crediting both actinides and fission products.</p>
<p>The MC USM data was taken directly from Table 7.2, “<span class="math inline">\(k_{eff}\)</span> bias and <span class="math inline">\(k_{eff}\)</span> bias uncertainty for the unpoisoned PWR SFP storage rack model using burnup credit actinide and fission product nuclides” in NUREG/CR-7108. As with the direct difference approach, the criticality models used in the MC USM approach are based on a representative PWR SFP storage rack model crediting both actinides and fission products.</p>
<p>The EPRI data in the analysis comes from: (1) the total uncertainty component derived in the EPRI benchmark report, which is summarized in Table 10-1, “Measured Cold Reactivity Decrement Bias and Uncertainty” and (2) the bias component derived in Section 6 of the EPRI utilization report applicable to the SCALE 6.1 depletion code used with ENDF/B-VII data. It should be noted that bias and uncertainty components are added together to form an effective 95/95 limit for consistent comparison to the other approaches that incidentally do not have bias components.</p>
<p>The Kopp 5% data in the analysis comes from an ongoing NRC effort to determine the expected reactivity impact due to specific SFP biases and uncertainties under various conditions. The NRC performed a review of approved license amendment requests (LARs) which include information on biases and uncertainties in SFP nuclear criticality safety (NCS) analyses. This document review has allowed the NRC to consolidate and assess a large amount of SFP NCS analysis data from NRC-approved real world applications. This data is relevant because (1) the SFP NCS data was produced through methodologies that have been reviewed and approved by the NRC, and (2) it represents practical application of NCS analysis methodologies, rather than theoretical situations established for the purposes of sensitivity studies.</p>
<p>The Kopp 5% data was collected from 33 approved SFP LARs dating back to the year 2000, which resulted in a database consisting of results from 163 individual criticality calculations. LARs that were withdrawn or LARs where the NRC did not explicitly review the NCS analysis were not included in the database.</p>
<h3 id="modeling">Modeling</h3>
<p>The R environment for statistical computing <span class="citation" data-cites="Rpackage">(<a href="#ref-Rpackage" role="doc-biblioref">R Core Team 2015</a>)</span> was used to determine approximate 95/95 tolerance intervals using both the R <code>predict</code> method for class <code>lm</code> with corrections using one-sided tolerance factors (based on the non-central t distribution) and two-sided tolerance factors using the formulations based on Section 7.2.6.3, “Tolerance intervals for a normal distribution,” of the National Institute of Standards and Technology <em>Engineering Statistics Handbook</em> <span class="citation" data-cites="natrella2013nist">(<a href="#ref-natrella2013nist" role="doc-biblioref">Natrella 2013</a>)</span>.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<h4 id="prediction-interval-correction-in-regression-analyses">Prediction interval correction in regression analyses</h4>
<p>It is possible to define a regression tolerance interval that accounts for increasing dependent variable variance as a function of the independent variable (i.e. heteroskedasticity) <span class="citation" data-cites="myhre2010tolerance">(<a href="#ref-myhre2010tolerance" role="doc-biblioref">Myhre et al. 2010</a>)</span>. However, this was not determined in Wallis’ 1951 work on the subject <span class="citation" data-cites="wallis1951tolerance">(<a href="#ref-wallis1951tolerance" role="doc-biblioref">Wallis 1951</a>)</span>. The necessary modification of Wallis’ work to account for heteroskedasticity is not part of the R <code>tolerance</code> library used in this analysis, and is therefore beyond the scope of this analysis. Instead, a conservative simplification was used.</p>
<p>For both the direct difference and NRC-adjusted EPRI approaches, 95% two-sided prediction intervals were <em>divided by 95/50 two-sided tolerance factors and multiplied by one-sided 95/95 tolerance factors to determine effective 95/95 tolerance intervals</em>; for determining regression tolerance factors, this requires calculation of the “effective number of observations” <span class="citation" data-cites="tolPackageR">(<a href="#ref-tolPackageR" role="doc-biblioref">Young 2010</a>)</span>.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> The reasoning behind using a 95/50 tolerance factor is based on the relationship between a prediction interval and a tolerance interval. That is, “a prediction interval can be stated to cover a specified proportion of a population on average, whereas a tolerance interval covers it with a certain confidence level” <span class="citation" data-cites="wikiTol">(<a href="#ref-wikiTol" role="doc-biblioref">Wikipedia 2016</a>)</span>. Taking this at face value, this would imply that a prediction interval can be approximated by a 95/50 tolerance interval. Using the definition of the prediction interval for the case of unknown mean and unknown variance and equating this to the tolerance interval, it is assumed that:</p>
<p><span class="math display">\[ T_{(1-p/2)} * \sqrt{1+(1/n)} \approx \sqrt{\frac{(n-1) * (1+1/n) * z_{(1-p)/2}^2}{\chi_{\gamma,n-1}^2}} \]</span></p>
<p>where n is the sample size, <span class="math inline">\(T_{(1-p/2)}\)</span> is the 100(1 - p/2)th percentile of Student’s t-distribution with n − 1 degrees of freedom, <span class="math inline">\(z_{(1-p)/2}\)</span> is the critical value of the normal distribution associated with cumulative probability (1 - p)/2, and <span class="math inline">\(\chi_{\gamma,n-1}^2\)</span> is the critical value of the <span class="math inline">\(\chi^2\)</span> distribution with n - 1 degrees of freedom with probability <span class="math inline">\(\gamma\)</span>.</p>
<p>As a check to see if the approximation above is valid, the two-sided 95% “prediction factor” was calculated and compared to the two-sided 95/50 tolerance factor for various sample sizes that bound those of the direct difference and EPRI datasets.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Set default font size to avoid setting for each plot individually</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/jrnold/ggthemes'>ggthemes</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/wch/extrafont'>extrafont</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>tolerance</span><span class='op'>)</span>
<span class='va'>scale_colour_discrete</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='fu'>scale_colour_brewer</span><span class='op'>(</span><span class='va'>...</span>, palette<span class='op'>=</span><span class='st'>"Set1"</span><span class='op'>)</span>
<span class='va'>scale_fill_discrete</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='fu'>scale_fill_brewer</span><span class='op'>(</span><span class='va'>...</span> , palette<span class='op'>=</span><span class='st'>"Set1"</span><span class='op'>)</span>
<span class='fu'>theme_set</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/ggthemes/man/theme_tufte.html'>theme_tufte</a></span><span class='op'>(</span>base_size <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Function to calculate tolerance factors based on sample size for various confidence levels</span>
<span class='va'>factorCheck</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>size</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>Confidence</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fl'>0.1</span>, to<span class='op'>=</span><span class='fl'>0.9</span>, by<span class='op'>=</span><span class='fl'>0.1</span><span class='op'>)</span>
    <span class='va'>toleranceFactor</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>
    <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='va'>Confidence</span><span class='op'>)</span> <span class='op'>{</span>
        <span class='va'>tol</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/tolerance/man/Kfactor.html'>K.factor</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='va'>size</span>, f<span class='op'>=</span><span class='va'>size</span><span class='op'>-</span><span class='fl'>1</span>, alpha<span class='op'>=</span><span class='fl'>1</span><span class='op'>-</span><span class='va'>i</span>,
                            P<span class='op'>=</span><span class='fl'>0.95</span>, side<span class='op'>=</span><span class='fl'>2</span>, method<span class='op'>=</span><span class='st'>"EXACT"</span>, m<span class='op'>=</span><span class='fl'>100</span><span class='op'>)</span>
        <span class='va'>toleranceFactor</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/append.html'>append</a></span><span class='op'>(</span><span class='va'>toleranceFactor</span>, <span class='va'>tol</span><span class='op'>)</span>
    <span class='op'>}</span>
    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>toleranceFactor</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Assemble a dataframe containing selected cases for assumption verification </span>
<span class='va'>check</span> <span class='op'>&lt;-</span> <span class='fu'>tbl_df</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Confidence<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fl'>0.1</span>, to<span class='op'>=</span><span class='fl'>0.9</span>, by<span class='op'>=</span><span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>cases</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>100</span>, <span class='fl'>1000</span><span class='op'>)</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='va'>cases</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>check</span> <span class='op'>&lt;-</span> <span class='fu'>bind_cols</span><span class='op'>(</span><span class='va'>check</span>, <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'>factorCheck</span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Format the data for plotting</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>check</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>cases</span>
<span class='va'>cases</span> <span class='op'>&lt;-</span> <span class='fu'>tbl_df</span><span class='op'>(</span><span class='fu'>reshape2</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/reshape2/man/melt.html'>melt</a></span><span class='op'>(</span><span class='va'>check</span>, id.vars<span class='op'>=</span><span class='st'>"Confidence"</span>, variable.name<span class='op'>=</span><span class='st'>"Case"</span>, value.name<span class='op'>=</span><span class='st'>"TolFactor"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>cases</span><span class='op'>$</span><span class='va'>Case</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>cases</span><span class='op'>$</span><span class='va'>Case</span><span class='op'>)</span><span class='op'>)</span><span class='op'>[</span><span class='va'>cases</span><span class='op'>$</span><span class='va'>Case</span><span class='op'>]</span>
<span class='va'>cases</span> <span class='op'>&lt;-</span>
    <span class='va'>cases</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>PredFactor<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/TDist.html'>qt</a></span><span class='op'>(</span>p<span class='op'>=</span><span class='op'>(</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>+</span><span class='fl'>0.95</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>)</span>, df<span class='op'>=</span><span class='va'>Case</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>/</span><span class='va'>Case</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>DeltaFactor<span class='op'>=</span><span class='va'>TolFactor</span> <span class='op'>-</span> <span class='va'>PredFactor</span><span class='op'>)</span>
<span class='va'>cases</span><span class='op'>$</span><span class='va'>Case</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>cases</span><span class='op'>$</span><span class='va'>Case</span><span class='op'>)</span>

<span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>cases</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>Confidence</span>, <span class='va'>DeltaFactor</span>, color<span class='op'>=</span><span class='va'>Case</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_point</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>geom_line</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_vline</span><span class='op'>(</span>xintercept<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_hline</span><span class='op'>(</span>yintercept<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Verification of equating 95% prediction factor with 95/50 tolerance factor"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="depletion-uncertainty-meta-analysis_files/figure-html5/unnamed-chunk-1-1.png" width="624" /></p>
</div>
<p>The plot directly above shows the difference between the 95/50 tolerance factors and the 95% prediction factors. The plot provides confirmation that the assumption of a 95/50 tolerance interval being approximately the same as a 95% prediction interval is valid for any sample size. The fact that the confidence level of the equivalent tolerance factor is greater than 50% indicates that using the 95/50 tolerance factor to represent the 95% prediction factor is conservative.</p>
<h4 id="direct-difference-data-analysis-approach">Direct difference data analysis approach</h4>
<p>For the NUREG/CR-7108 direct difference data analysis, a weighted linear least-squares (WLS) regression model was selected due to the observed heteroskedasticity with burnup. A major assumption that goes into the WLS model is the choice of burnup-dependent weights, as this dictates both the regression line <em>and</em> the prediction interval(s). The weights were rigorously selected based on conditional variance function estimation as discussed in Section 7.3, “Conditional Variance Function Estimation” using an iterative process from the <em>Advanced Data Analysis from an Elementary Point of View</em> textbook; the regression line was also determined iteratively <span class="citation" data-cites="shalizi2013advanced">(<a href="#ref-shalizi2013advanced" role="doc-biblioref">Shalizi 2016</a>)</span>.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> Specifically, the <code>iterative.wls</code> function in Chapter 7 was used without modification. The direct difference data residuals were fit non-parametrically as a function of burnup and this fit was used directly for the weights in the WLS regression model and more importantly in generating the corresponding burnup-dependent prediction interval. The reason for using this approach to define the regression line, weights, and prediction interval was to treat the data as objectively as possible without prescribing arbitrary constraints.</p>
<p>A two-sided 95% prediction interval was used as the basis for the direct difference data regression fit uncertainty with a 95/95 tolerance factor adjustment. The 95/95 tolerance factor adjustment is dictated by the effective number of observations corresponding to the particular dataset. The effective number of observations is given by the following formulation:</p>
<p><span class="math display">\[ n_{i}^{*} = \frac{\hat{\sigma}^2}{s.e.(\hat{y_i})^2} \]</span></p>
<p>where <span class="math inline">\(n_{i}^{*}\)</span> is the effective number of observations for the ith observation, <span class="math inline">\(\hat{\sigma}\)</span> is the sample standard deviation, and <span class="math inline">\(s.e.(\hat{y_i})\)</span> is the standard error of the ith observation. The sample standard deviation is approximated by the root mean square error (RMSE), which, in this case, reflects the deviation of the predictions about a reference observed value of 0 for all burnups. The reference observed value of 0 represents the case of perfect agreement between code predictions and measurements, therefore the RMSE with this as a reference should give the desired measure of “standard deviation” required for the effective number of observations calculation. In this analysis, all of the data was used to calculate the RMSE.</p>
<p>To simplify the calculation of the standard error of the ith observation, a single conservative standard error was chosen to represent all observations. This was done by calculating the standard deviation of all observations greater than or equal to a burnup of 30 GWd/MTU where the variance of the data becomes significantly higher. Due to the pronounced heteroskedasticity of the data, it would be more accurate to define a burnup-dependent estimate of standard error; however, it was desirable to have a single effective number of observations for use in estimating a reasonably conservative 95/95 tolerance factor.</p>
<h4 id="nrc-adjusted-epri-data-analysis-approach">NRC-adjusted EPRI data analysis approach</h4>
<p>For the NRC-adjusted EPRI validation approach, EPRI’s regression model was used to characterize the bias. However, <em>the upper limit</em> of (the assumed to be) two-sided 95% prediction interval from Figure 9, “Reactivity Quadratic Regression for Cycle-collapsed Data” from Attachment 2, “EPRI Analysis for Determining the 95/95 Confidence Limits on CASMO Hot Full Power (HFP) Measured Reactivity Decrement Bias Regressions Used in the EPRI/Studsvik Burnup Benchmark” as part of the “Responses to Follow-up RAIs for EPRI Report 1022503 and EPRI Report 1022909” was used as the basis for the regression fit uncertainty <span class="citation" data-cites="epriRESPc2016">(<a href="#ref-epriRESPc2016" role="doc-biblioref">Cummings 2016</a>)</span>. Note that because the heteroskedasticity of the EPRI data is not as pronounced as that for the direct difference data, the 95/95 tolerance factor determined is not as penalizing at lower burnups as in the direct difference case. The Appendix contains annotated R source code showing the generation of this approximate one-sided 95/95 tolerance interval and the various assumptions made.</p>
<h3 id="comparison-of-independent-9595-depletion-code-bias-plus-uncertainty-characterizations">Comparison of Independent 95/95 Depletion Code Bias Plus Uncertainty Characterizations</h3>
<p>The figure directly below shows both the data (where available) along with the corresponding independent 95/95 depletion code bias and uncertainty characterizations. Note that the “EPRIstat” data corresponds to the NRC-adjusted EPRI validation approach. The overall shape of the bias plus uncertainty intervals are very similar among all of the approaches except for the EPRI characterization which is seen to be relatively constant and much smaller than the others as a function of burnup. It should also be noted that lower rather than upper intervals for all of the approaches are derived because the negative reactivity differences indicate depletion code underprediction of spent fuel reactivity and it is desirable to find the statistically limiting amount of underprediction as a function of burnup. <strong><em>This needs to be confirmed to be true for the EPRI data.</em></strong></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Script to generate plot comparing depletion validation approaches</span>

<span class='co'># Load direct difference data</span>
<span class='va'>NUREG7108</span> <span class='op'>&lt;-</span> <span class='fu'>tbl_df</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"data/7108DDdata.csv"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>db<span class='op'>=</span><span class='st'>"directDiff"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>db</span>, <span class='va'>burnup</span>, <span class='va'>dk</span><span class='op'>)</span>

<span class='co'># Load SFP NCS database to pull Kopp 5% data</span>
<span class='co'>#source("scripts/loadSFPncsData.R")</span>
<span class='fu'><a href='https://rdrr.io/r/base/load.html'>load</a></span><span class='op'>(</span><span class='st'>"data/sfpCritUncAnalysis.Rdata"</span><span class='op'>)</span>
<span class='va'>pwrDepUnc</span> <span class='op'>&lt;-</span> <span class='va'>LWRtols</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>db</span><span class='op'>==</span><span class='st'>"NRC-PWR"</span>, <span class='va'>tol</span><span class='op'>==</span><span class='st'>"depUnc"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>db<span class='op'>=</span><span class='st'>"Kopp5%"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>db</span>, <span class='va'>burnup</span>, <span class='va'>dk</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='co'># Load EPRI data - this dataframe is constructed by adding the CASMO-5 95% uncertainty from Table 10-1 in EPRI Report 1022909, Rev. 0 (2011) with the 150 pcm bias determined from Section 6 of EPRI Report 1025203, Rev. 0 (2012).</span>
<span class='va'>EPRIbias</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='op'>-</span><span class='op'>(</span><span class='fl'>150</span><span class='op'>+</span><span class='op'>(</span><span class='fl'>643</span><span class='op'>-</span><span class='fl'>576</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>1e5</span>, <span class='fl'>6</span><span class='op'>)</span>  <span class='co'># from utilization report for SCALE 6.1 w/ ENDF/B-VII data</span>
<span class='va'>EPRIunc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.00521</span>, <span class='op'>-</span><span class='fl'>0.00576</span>, <span class='op'>-</span><span class='fl'>0.00571</span>, <span class='op'>-</span><span class='fl'>0.00560</span>, <span class='op'>-</span><span class='fl'>0.00540</span>, <span class='op'>-</span><span class='fl'>0.00534</span><span class='op'>)</span>  <span class='co'># from benchmark report for CASMO-5 + SIMULATE-3 w/ ENDF/B-VII data + others</span>
<span class='va'>EPRItot</span> <span class='op'>&lt;-</span> <span class='va'>EPRIbias</span> <span class='op'>+</span> <span class='va'>EPRIunc</span>
<span class='va'>EPRI95</span> <span class='op'>&lt;-</span>
    <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>db<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPRI"</span>,<span class='st'>"EPRI"</span>,<span class='st'>"EPRI"</span>,<span class='st'>"EPRI"</span>,<span class='st'>"EPRI"</span>,<span class='st'>"EPRI"</span><span class='op'>)</span>,
               burnup<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>20</span>,<span class='fl'>30</span>,<span class='fl'>40</span>,<span class='fl'>50</span>,<span class='fl'>60</span><span class='op'>)</span>,
               dk<span class='op'>=</span><span class='va'>EPRItot</span>
               <span class='op'>)</span>

<span class='co'># Merge separate datasets into one for more convenient processing</span>

<span class='va'>pPWRdepU</span> <span class='op'>&lt;-</span> <span class='fu'>bind_rows</span><span class='op'>(</span><span class='va'>NUREG7108</span>, <span class='va'>pwrDepUnc</span>, <span class='va'>EPRI95</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>db</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>db</span>, <span class='va'>burnup</span><span class='op'>)</span>

<span class='co'># Fit models from datasets</span>

<span class='co'># Fit the data to a linear model</span>

    <span class='co'># An ordinary linear least-squares fit is performed on all non-direct-difference data</span>
    <span class='co'>#library(broom)</span>
    <span class='co'>#library(tolerance)</span>
    <span class='va'>linFits</span> <span class='op'>&lt;-</span>
        <span class='va'>pPWRdepU</span>  <span class='op'>%&gt;%</span> <span class='fu'>do</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/tolerance/man/regtolint.html'>regtol.int</a></span><span class='op'>(</span>reg <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>dk</span><span class='op'>~</span><span class='va'>burnup</span>, <span class='va'>.</span><span class='op'>)</span>, new.x<span class='op'>=</span><span class='cn'>NULL</span>, alpha<span class='op'>=</span><span class='fl'>0.05</span>, P<span class='op'>=</span><span class='fl'>0.95</span>, side<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>db</span><span class='op'>!=</span><span class='st'>"directDiff"</span><span class='op'>)</span>
    
    <span class='co'># A weighted linear least-squares fit is performed on direct-difference data</span>
    <span class='va'>w</span> <span class='op'>&lt;-</span> <span class='va'>NUREG7108</span><span class='op'>$</span><span class='va'>burnup</span><span class='op'>^</span><span class='fl'>1.0</span> 
    <span class='va'>linFitsWgtDD</span> <span class='op'>&lt;-</span>
         <span class='va'>pPWRdepU</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>db</span> <span class='op'>==</span> <span class='st'>"directDiff"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
         <span class='fu'>do</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/tolerance/man/regtolint.html'>regtol.int</a></span><span class='op'>(</span>reg <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>dk</span><span class='op'>~</span><span class='va'>burnup</span>, weights <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='va'>w</span>, <span class='va'>.</span><span class='op'>)</span>, new.x<span class='op'>=</span><span class='cn'>NULL</span>, alpha<span class='op'>=</span><span class='fl'>0.05</span>, P<span class='op'>=</span><span class='fl'>0.95</span>, side<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Merge the original data with the fit + tolerance interval</span>

    <span class='co'>### Process the LS fits for plotting</span>
    <span class='va'>allLinFits</span> <span class='op'>&lt;-</span> <span class='fu'>bind_rows</span><span class='op'>(</span><span class='va'>linFits</span>, <span class='va'>linFitsWgtDD</span><span class='op'>)</span>
    <span class='va'>tols</span> <span class='op'>&lt;-</span> <span class='fu'>tbl_df</span><span class='op'>(</span><span class='va'>allLinFits</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='fu'>everything</span><span class='op'>(</span><span class='op'>)</span>, lwr<span class='op'>=</span><span class='fu'>contains</span><span class='op'>(</span><span class='st'>"lower"</span><span class='op'>)</span>, upr<span class='op'>=</span><span class='fu'>contains</span><span class='op'>(</span><span class='st'>"upper"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>db</span><span class='op'>)</span>
    <span class='va'>bu</span> <span class='op'>&lt;-</span> <span class='va'>pPWRdepU</span> <span class='op'>%&gt;%</span> <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>db</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>burnup</span><span class='op'>)</span>
    <span class='va'>dk</span> <span class='op'>&lt;-</span> <span class='va'>pPWRdepU</span> <span class='op'>%&gt;%</span> <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>db</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>dk</span><span class='op'>)</span>
    <span class='va'>pLinFits</span> <span class='op'>&lt;-</span> <span class='fu'>bind_cols</span><span class='op'>(</span><span class='va'>bu</span>, <span class='va'>dk</span>, <span class='va'>tols</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>db</span>, <span class='va'>burnup</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>db</span>, <span class='fu'>everything</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Plot desired datasets    </span>

    <span class='co'># Plot of WLS direct difference data fit and other OLS data fits</span>
    <span class='co'># Translating Kopp 5% curve for comparison using consistent reactivity difference basis</span>
    <span class='va'>fpLinFits</span> <span class='op'>&lt;-</span>
        <span class='va'>pLinFits</span> <span class='op'>%&gt;%</span>
        <span class='fu'>mutate</span><span class='op'>(</span>dk2<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>db</span><span class='op'>==</span><span class='st'>"Kopp5%"</span>, <span class='op'>-</span><span class='fl'>1</span><span class='op'>*</span><span class='va'>dk</span>, <span class='va'>dk</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>dk</span>, dk<span class='op'>=</span><span class='va'>dk2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='fu'>mutate</span><span class='op'>(</span>lwr2<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>db</span><span class='op'>==</span><span class='st'>"Kopp5%"</span>, <span class='op'>-</span><span class='fl'>1</span><span class='op'>*</span><span class='va'>lwr</span>, <span class='va'>lwr</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>lwr</span>, lwr<span class='op'>=</span><span class='va'>lwr2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='fu'>mutate</span><span class='op'>(</span>upr2<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>db</span><span class='op'>==</span><span class='st'>"Kopp5%"</span>, <span class='op'>-</span><span class='fl'>1</span><span class='op'>*</span><span class='va'>upr</span>, <span class='va'>upr</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>upr</span>, upr<span class='op'>=</span><span class='va'>upr2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='fu'>mutate</span><span class='op'>(</span>y.hat2<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>db</span><span class='op'>==</span><span class='st'>"Kopp5%"</span>, <span class='op'>-</span><span class='fl'>1</span><span class='op'>*</span><span class='va'>y.hat</span>, <span class='va'>y.hat</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>y.hat</span>, y.hat<span class='op'>=</span><span class='va'>y.hat2</span><span class='op'>)</span>

    <span class='va'>fpLinFits</span> <span class='op'>&lt;-</span>
        <span class='va'>fpLinFits</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>lwr<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>db</span><span class='op'>==</span><span class='st'>"Kopp5%"</span>, <span class='va'>upr</span>, <span class='va'>lwr</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>upr<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>db</span><span class='op'>==</span><span class='st'>"Kopp5%"</span>, <span class='va'>lwr</span>, <span class='va'>upr</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>rename</span><span class='op'>(</span>fit<span class='op'>=</span><span class='va'>y.hat</span><span class='op'>)</span>
    
    <span class='co'># Replace 95% prediction interval with 95/95 tolerance interval</span>
    
    <span class='co'># Function used to define WLS weights</span>
    <span class='va'>iterative.wls</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>tol</span> <span class='op'>=</span> <span class='fl'>0.01</span>, <span class='va'>max.iter</span> <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span> <span class='op'>{</span>
        <span class='va'>iteration</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
        <span class='va'>old.coefs</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
        <span class='va'>regression</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span><span class='op'>)</span>
        <span class='va'>coefs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coefficients</a></span><span class='op'>(</span><span class='va'>regression</span><span class='op'>)</span>
        <span class='kw'>while</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>old.coefs</span><span class='op'>)</span> <span class='op'>||</span> <span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>coefs</span> <span class='op'>-</span> <span class='va'>old.coefs</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='va'>tol</span><span class='op'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>(</span><span class='va'>iteration</span> <span class='op'>&lt;</span>
        <span class='va'>max.iter</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
        <span class='va'>variance</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/np/man/np.regression.html'>npreg</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>regression</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>~</span> <span class='va'>x</span><span class='op'>)</span>
        <span class='va'>old.coefs</span> <span class='op'>&lt;-</span> <span class='va'>coefs</span>
        <span class='va'>iteration</span> <span class='op'>&lt;-</span> <span class='va'>iteration</span> <span class='op'>+</span> <span class='fl'>1</span>
        <span class='va'>regression</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span>, weights <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></span><span class='op'>(</span><span class='va'>variance</span><span class='op'>)</span><span class='op'>)</span>
        <span class='va'>coefs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coefficients</a></span><span class='op'>(</span><span class='va'>regression</span><span class='op'>)</span>
        <span class='op'>}</span>
        <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>regression <span class='op'>=</span> <span class='va'>regression</span>, variance <span class='op'>=</span> <span class='va'>variance</span>, iterations <span class='op'>=</span> <span class='va'>iteration</span><span class='op'>)</span><span class='op'>)</span>
    <span class='op'>}</span>
    
    <span class='co'># Grab direct difference data</span>
    <span class='va'>DDdata</span> <span class='op'>&lt;-</span> <span class='va'>fpLinFits</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>db</span><span class='op'>==</span><span class='st'>"directDiff"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>burnup</span>, <span class='va'>dk</span><span class='op'>)</span>
    <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/JeffreyRacine/R-Package-np'>np</a></span><span class='op'>)</span>
    <span class='co'># Calculate the residuals of the direct difference data</span>
    <span class='va'>log</span> <span class='op'>&lt;-</span>
        <span class='fu'><a href='https://rdrr.io/r/utils/capture.output.html'>capture.output</a></span><span class='op'>(</span><span class='op'>{</span>
           <span class='va'>test</span> <span class='op'>&lt;-</span> <span class='fu'>iterative.wls</span><span class='op'>(</span><span class='va'>DDdata</span><span class='op'>$</span><span class='va'>burnup</span>, <span class='va'>DDdata</span><span class='op'>$</span><span class='va'>dk</span><span class='op'>)</span>
        <span class='op'>}</span><span class='op'>)</span>
    <span class='va'>varPoints</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>test</span><span class='op'>$</span><span class='va'>variance</span><span class='op'>)</span>
    <span class='co'># Fit the residual over burnup to get WLS weights</span>
    <span class='va'>varFit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>test</span><span class='op'>$</span><span class='va'>variance</span>, exdat<span class='op'>=</span><span class='va'>DDdata</span><span class='op'>$</span><span class='va'>burnup</span><span class='op'>)</span>
    
    <span class='co'># This is to visually check the weight function</span>
    <span class='co'># plot(x=DDdata$burnup, y=varPoints)</span>
    <span class='co'># lines(DDdata$burnup, varFit)</span>
    
    <span class='co'># This is to see how the direct difference delta-k data is distributed </span>
    <span class='co'># q &lt;- DDdata$dk</span>
    <span class='co'># par(mfrow=c(1,2))</span>
    <span class='co'># hist(q, main="Distribution", xlab="K-eff")</span>
    <span class='co'># qqnorm(q)</span>
    <span class='co'># qqline(q)</span>
    <span class='co'># result &lt;- shapiro.test(q)</span>
    <span class='co'># result$p.value</span>

    <span class='co'># Set the WLS weights equal to the fit of the direct difference residuals</span>
    <span class='va'>w</span> <span class='op'>&lt;-</span> <span class='va'>varFit</span>
    <span class='co'># Calculate the two-sided direct difference 95% prediction interval</span>
    <span class='va'>linFitsWgtDD</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>test</span><span class='op'>$</span><span class='va'>regression</span>, <span class='va'>DDdata</span>, interval <span class='op'>=</span> <span class='st'>"prediction"</span>, weights <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='va'>w</span><span class='op'>)</span>
    <span class='va'>linFitsWgtDD</span> <span class='op'>&lt;-</span> <span class='fu'>tbl_df</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>linFitsWgtDD</span><span class='op'>)</span><span class='op'>)</span>
    
    <span class='co'># Function definining the one-sided tolerance factor</span>
    <span class='va'>k1</span> <span class='op'>&lt;-</span>
        <span class='kw'>function</span><span class='op'>(</span><span class='va'>samp</span>, <span class='va'>cov</span>, <span class='va'>conf</span><span class='op'>)</span><span class='op'>{</span>
            <span class='va'>n</span> <span class='op'>=</span> <span class='va'>samp</span>                  <span class='co'># number of samples</span>
            <span class='va'>p</span> <span class='op'>=</span> <span class='va'>cov</span>                   <span class='co'># coverage parameter</span>
            <span class='va'>g</span> <span class='op'>=</span> <span class='va'>conf</span>                  <span class='co'># confidence parameter</span>
            <span class='va'>f</span> <span class='op'>=</span> <span class='va'>n</span> <span class='op'>-</span> <span class='fl'>1</span>                 <span class='co'># degrees of freedom</span>
            <span class='va'>delta</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>  <span class='co'># non-centrality parameter</span>
            <span class='va'>k</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/TDist.html'>qt</a></span><span class='op'>(</span><span class='va'>g</span>,<span class='va'>f</span>,<span class='va'>delta</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span> <span class='co'># k-factor for a one-sided tolerance interval</span>
            <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>k</span><span class='op'>)</span>
        <span class='op'>}</span>
    
    <span class='co'># The RMSE is estimated to be:</span>
    <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/hzambran/hydroGOF'>hydroGOF</a></span><span class='op'>)</span>
    <span class='va'>RMSE</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/hydroGOF/man/rmse.html'>rmse</a></span><span class='op'>(</span>sim<span class='op'>=</span><span class='va'>NUREG7108</span><span class='op'>$</span><span class='va'>dk</span>, obs<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>NUREG7108</span><span class='op'>$</span><span class='va'>dk</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
    <span class='co'># The standard error is estimated to be:</span>
    <span class='va'>subset</span> <span class='op'>&lt;-</span> <span class='va'>NUREG7108</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>burnup</span> <span class='op'>&gt;=</span> <span class='fl'>30</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>dk</span><span class='op'>)</span>  <span class='co'># a subset of the data is used for conservatism</span>
    <span class='va'>stdErr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>subset</span><span class='op'>$</span><span class='va'>dk</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>subset</span><span class='op'>$</span><span class='va'>dk</span><span class='op'>)</span><span class='op'>)</span>
    <span class='co'># Therfore, the effective number of observations is:</span>
    <span class='va'>nEff</span> <span class='op'>&lt;-</span>  <span class='va'>RMSE</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>/</span><span class='va'>stdErr</span><span class='op'>^</span><span class='fl'>2</span>
    <span class='co'># To determine a penalty for using a 95/50 regression tolerance interval instead of a 95/95 regression tolerance interval, the regression fit uncertainty is increased by the following factor:</span>
    <span class='va'>adjFactorDD</span> <span class='op'>&lt;-</span> <span class='fu'>k1</span><span class='op'>(</span><span class='va'>nEff</span>,<span class='fl'>0.95</span>,<span class='fl'>0.95</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/pkg/tolerance/man/Kfactor.html'>K.factor</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='va'>nEff</span>, f<span class='op'>=</span><span class='va'>nEff</span><span class='op'>-</span><span class='fl'>1</span>, alpha<span class='op'>=</span><span class='fl'>1</span><span class='op'>-</span><span class='fl'>0.50</span>, P<span class='op'>=</span><span class='fl'>0.95</span>, side<span class='op'>=</span><span class='fl'>2</span>, method<span class='op'>=</span><span class='st'>"EXACT"</span>, m<span class='op'>=</span><span class='fl'>100</span><span class='op'>)</span>

    <span class='co'># The original homoskedastic 95/95 tolerance interval is replaced with an effective 95/95 heteroskedastic tolerance interval</span>
    <span class='va'>linFitsWgtDD</span> <span class='op'>&lt;-</span>
        <span class='va'>linFitsWgtDD</span> <span class='op'>%&gt;%</span>
        <span class='fu'>bind_cols</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>burnup<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='va'>NUREG7108</span><span class='op'>$</span><span class='va'>burnup</span><span class='op'>)</span><span class='op'>)</span>, <span class='va'>.</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='co'>## This modeling assumption assumes the 95/95 tolerance factor correction corresponding to the </span>
        <span class='co'>## highest burnup also applies to all other burnups; this is likely overly conservative.</span>
        <span class='fu'>mutate</span><span class='op'>(</span>lwr<span class='op'>=</span><span class='va'>lwr</span><span class='op'>*</span><span class='va'>adjFactorDD</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='co'>## This modeling assumption discounts the 95/95 tolerance factor correction for lower burnups</span>
        <span class='co'>## based on the shape of the data; this is likely more reasonable, but uses engineering</span>
        <span class='co'>## judgment.</span>
        <span class='co'># mutate(shape=ifelse(adjFactorDD*lwr/min(lwr) &gt; 1, adjFactorDD*lwr/min(lwr), 1) ) %&gt;%</span>
        <span class='co'># mutate(lwr=lwr*shape) %&gt;% </span>
        <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>upr</span><span class='op'>)</span>
    
    <span class='co'># This is to visually check the shape of the burnup-dependent correction</span>
    <span class='co'># ggplot(linFitsWgtDD %&gt;%</span>
    <span class='co'>#           melt(., id.vars=c("burnup")) %&gt;%</span>
    <span class='co'>#           group_by(variable) %&gt;%</span>
    <span class='co'>#           mutate(normVal=value/last(value)) %&gt;%</span>
    <span class='co'>#           filter(variable=="lwr" | variable=="shape") %&gt;%</span>
    <span class='co'>#           select(-value),</span>
    <span class='co'>#       aes(burnup, normVal, color=variable)) + geom_line()</span>
    
    <span class='co'># Add the effective 95/95 heterodskedastic tolerance interval to the dataframe with the other approaches</span>
    <span class='va'>fpLinFits</span> <span class='op'>&lt;-</span> <span class='va'>fpLinFits</span> <span class='op'>%&gt;%</span>
                    <span class='fu'>mutate</span><span class='op'>(</span>lwr<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>db</span><span class='op'>==</span><span class='st'>"directDiff"</span>, <span class='va'>linFitsWgtDD</span><span class='op'>$</span><span class='va'>lwr</span>, <span class='va'>lwr</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                    <span class='co'># mutate(upr=ifelse(db=="directDiff", linFitsWgtDD$upr, upr)) %&gt;%</span>
                    <span class='fu'>mutate</span><span class='op'>(</span>fit<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>db</span><span class='op'>==</span><span class='st'>"directDiff"</span>, <span class='va'>linFitsWgtDD</span><span class='op'>$</span><span class='va'>fit</span>, <span class='va'>fit</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                    <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>upr</span><span class='op'>)</span>
    
    <span class='co'># Perform the NRC-adjusted EPRI approach</span>
    <span class='kw'><a href='https://rdrr.io/r/base/source.html'>source</a></span><span class='op'>(</span><span class='st'>"scripts/k1correctionEPRIstat.R"</span><span class='op'>)</span> 
    <span class='va'>EPRIuncData</span> <span class='op'>&lt;-</span> <span class='va'>EPRIadj</span>
    
    <span class='co'># Create and format the EPRIstat dataframe to be compatible with combined dataframe</span>
    <span class='va'>EPRIstat</span> <span class='op'>&lt;-</span>
        <span class='va'>fpLinFits</span> <span class='op'>%&gt;%</span>
        <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>db</span><span class='op'>==</span><span class='st'>"EPRI"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='fu'>mutate</span><span class='op'>(</span>dk<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='fl'>6</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='fu'>mutate</span><span class='op'>(</span>fit<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>19</span>, <span class='fl'>46</span>, <span class='fl'>81</span>, <span class='fl'>125</span>, <span class='fl'>177</span>, <span class='fl'>238</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>1e5</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='fu'>mutate</span><span class='op'>(</span>lwr<span class='op'>=</span><span class='op'>-</span><span class='va'>EPRIuncData</span><span class='op'>$</span><span class='va'>BandU</span><span class='op'>/</span><span class='fl'>1e5</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='fu'>mutate</span><span class='op'>(</span>db<span class='op'>=</span><span class='st'>"EPRIstat"</span><span class='op'>)</span>
    
    <span class='co'># Add the EPRIstat dataframe to the combined dataframe</span>
    <span class='va'>fpLinFits</span> <span class='op'>&lt;-</span> 
        <span class='fu'>bind_rows</span><span class='op'>(</span><span class='va'>fpLinFits</span>, <span class='va'>EPRIstat</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>db</span><span class='op'>)</span>

    <span class='co'># Update and format the EPRI dataframe to be compatible with combined dataframe</span>
    <span class='va'>EPRIupd</span> <span class='op'>&lt;-</span>
        <span class='va'>fpLinFits</span> <span class='op'>%&gt;%</span> 
        <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>db</span><span class='op'>==</span><span class='st'>"EPRI"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='fu'>mutate</span><span class='op'>(</span>dk<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='fl'>6</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='fu'>mutate</span><span class='op'>(</span>fit<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>19</span>, <span class='fl'>46</span>, <span class='fl'>81</span>, <span class='fl'>125</span>, <span class='fl'>177</span>, <span class='fl'>238</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>1e5</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='fu'>mutate</span><span class='op'>(</span>lwr<span class='op'>=</span><span class='va'>EPRItot</span><span class='op'>)</span>
        
    <span class='co'># Update the EPRI data in the combined dataframe</span>
    <span class='va'>fpLinFits</span> <span class='op'>&lt;-</span> <span class='fu'>bind_rows</span><span class='op'>(</span><span class='va'>fpLinFits</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>db</span><span class='op'>!=</span><span class='st'>"EPRI"</span><span class='op'>)</span>, <span class='va'>EPRIupd</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>db</span><span class='op'>)</span>
    
    <span class='co'># Create and format the MC USM dataframe to be compatible with combined dataframe</span>
    <span class='va'>MCUSM</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>burnup<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>40</span>,<span class='fl'>50</span>,<span class='fl'>60</span><span class='op'>)</span>, dk<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.0190</span>,<span class='fl'>0.0188</span>,<span class='fl'>0.0219</span>,<span class='fl'>0.0300</span><span class='op'>)</span>, fit<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.0046</span>,<span class='fl'>0.0034</span>,<span class='fl'>0.0061</span>,<span class='fl'>0.0105</span><span class='op'>)</span><span class='op'>)</span>
    <span class='va'>MCUSM</span> <span class='op'>&lt;-</span> 
        <span class='fu'>tbl_df</span><span class='op'>(</span><span class='va'>MCUSM</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='fu'>mutate</span><span class='op'>(</span>db<span class='op'>=</span><span class='st'>"MC USM"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
        <span class='fu'>mutate</span><span class='op'>(</span>alpha<span class='op'>=</span><span class='cn'>NA</span>, P<span class='op'>=</span><span class='cn'>NA</span>, y<span class='op'>=</span><span class='cn'>NA</span>, lwr<span class='op'>=</span><span class='op'>-</span><span class='va'>dk</span>, dk<span class='op'>=</span><span class='cn'>NA</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='fu'>select</span><span class='op'>(</span><span class='va'>db</span>, <span class='va'>burnup</span>, <span class='va'>alpha</span>, <span class='va'>P</span>, <span class='va'>y</span>, <span class='va'>dk</span>, <span class='va'>lwr</span>, <span class='va'>fit</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>db</span><span class='op'>)</span>
    
    <span class='co'># Add the MC USM dataframe to the combined dataframe</span>
    <span class='va'>fpLinFits</span> <span class='op'>&lt;-</span> <span class='fu'>bind_rows</span><span class='op'>(</span><span class='va'>fpLinFits</span>, <span class='va'>MCUSM</span><span class='op'>)</span>
    
    <span class='co'># Plot the actual bias and uncertainty characterizations with the underlying data where available</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>fpLinFits</span>,
        <span class='fu'>aes</span><span class='op'>(</span><span class='va'>burnup</span>, <span class='va'>dk</span>, color<span class='op'>=</span><span class='va'>db</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>  <span class='fu'>geom_point</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_line</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>burnup</span>, y<span class='op'>=</span><span class='va'>fit</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
        <span class='fu'>geom_ribbon</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>ymin<span class='op'>=</span><span class='va'>lwr</span>, ymax<span class='op'>=</span><span class='va'>fit</span><span class='op'>)</span>, alpha<span class='op'>=</span><span class='fl'>0.1</span><span class='op'>)</span> <span class='op'>+</span>
        <span class='co'># scale_y_continuous(breaks = seq(-0.03, 0.05, by = 0.005), limits=c(-0.03, 0.05)) +</span>
        <span class='fu'>labs</span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Independent 95/95 depletion code bias and uncertainty characterizations"</span>,
             x<span class='op'>=</span><span class='st'>"Burnup (GWd/MTU)"</span>,
             y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>Delta</span>, <span class='va'>k</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="depletion-uncertainty-meta-analysis_files/figure-html5/unnamed-chunk-2-1.png" width="624" /></p>
</div>
<p>The linear fits seem to provide a good representation of the average behavior with the fit intercept tending toward 0 at 0 burnup as is physically expected for all of the validation approaches. However, one of the main observations is that due to the 95/95 aspect of the analyses, data outliers have disproportionate weight, and drive the overall uncertainty as is seen with the Kopp 5% and direct difference intervals.<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></p>
<p>Another observation is that the MC USM and direct difference approaches are in relative agreement; however, the direct difference approach fails to pick up the more refined MC USM uncertainty shape. The direct difference tolerance interval also begins to decrease from a burnup of 54 GWd/MTU and up, which is a result of the non-parametric fitting of the direct difference data residuals discussed previously. While this is arguably unphysical, this is the result of an objective treatment of the available data.</p>
<p>Interestingly, the NRC-adjusted EPRI approach uncertainty appears to agree relatively well with the two NUREG/CR-7108 approach characterizations confirming the possibility discussed earlier that performing a MC USM or direct difference approach to validate SCALE 6.1 TRITON could result in very similar depletion uncertainty versus burnup characterization when using the EPRI validation approach with either CASMO-5 or SCALE 6.1 TRITON. However, it should be emphasized that this may be purely coincidental since there were no attempts to quantify measurement uncertainties for either validation approach.</p>
<p>The formal 95/95 depletion code bias plus uncertainty characterizations also indicate that the Kopp 5% validation approach is not necessarily conservative.</p>
<p>As seen in the figure above, there is a positive bias that increases with increasing burnup <strong><em>for each of the approaches that make use of statistical tolerance intervals</em></strong>. This indicates that SFP reactivity is being overpredicted on average. Not crediting this positive bias is likely a significant conservatism. Note that by definition, the Kopp 5% only has an uncertainty component, therefore there is no bias component.</p>
<p>For the final bias treatment, no credit is taken for positive biases; negative bias should always be credited. For the final uncertainty treatment, the 95/95 uncertainty is defined by the difference between the lower 95/95 limit and the fit unless the fit is positive. If the fit is positive, then the difference between the lower 95/95 limit and zero is used to define the 95/95 uncertainty. This is done to reasonably discount any k-effective overprediction component from the uncertainty while not allowing it to be credited as a non-conservative bias; this is consistent with ANSI/ANS-8.27-2015, “Burnup Credit for LWR Fuel” <span class="citation" data-cites="ans827">(<a href="#ref-ans827" role="doc-biblioref">ANS 2015</a>)</span>.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> The figure below shows the resultant 95/95 bias plus uncertainty characterizations compared to the OLS <em>fit</em><a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a> of the Kopp 5% data based on the preceding rules.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Add negative bias and uncertainty components together</span>
<span class='va'>comp</span> <span class='op'>&lt;-</span>
    <span class='va'>fpLinFits</span> <span class='op'>%&gt;%</span>
    <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>db</span>, <span class='va'>burnup</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>db</span>, <span class='va'>burnup</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='co'># If Kopp 5% data, only plot the fit; otherwise, add negative bias and uncertainty components together subtracting off any positive bias component greater than 0 from the uncertainty component and not crediting any positive bias component greater than 0.</span>
    <span class='fu'>mutate</span><span class='op'>(</span>dk<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>db</span><span class='op'>==</span><span class='st'>"Kopp5%"</span>, <span class='va'>fit</span>, <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>fit</span> <span class='op'>&gt;=</span> <span class='fl'>0</span>, <span class='va'>lwr</span>, <span class='va'>fit</span><span class='op'>+</span><span class='va'>lwr</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>select</span><span class='op'>(</span><span class='va'>db</span>, <span class='va'>burnup</span>, <span class='va'>fit</span>, <span class='va'>dk</span><span class='op'>)</span>
    
<span class='co'># Plot the bias plus uncertainty characterizations</span>
<span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>comp</span>, <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>burnup</span>, y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>dk</span><span class='op'>)</span>, color<span class='op'>=</span><span class='va'>db</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_line</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='co'># scale_y_continuous(breaks = seq(0, 0.03, by = 0.0025), limits=c(0, 0.03)) +</span>
    <span class='fu'>labs</span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Independent 95/95 depletion code bias plus uncertainty characterizations"</span>,
         x<span class='op'>=</span><span class='st'>"Burnup (GWd/MTU)"</span>,
         y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"abs("</span>, <span class='va'>Delta</span>, <span class='st'>"k)"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="depletion-uncertainty-meta-analysis_files/figure-html5/unnamed-chunk-3-1.png" width="624" /></p>
</div>
<h2 id="conclusion">Conclusion</h2>
<p>The SFP regulatory requirements of 10 CFR 50.68(b)(4) imply that 95/95 tolerance limits be calculated for any regression analysis used to support the validation of a depletion code for crediting burnup in SFP criticality calculations. The regression analyses performed and assumptions made in applying: (1) the direct difference approach to the NUREG/CR-7108 SFP example and (2) the EPRI depletion benchmark approach to the example using SCALE 6.1 with ENDF/B-VII data presents the NRC staff’s understanding of how the 10 CFR 50.68(b)(4) requirements can be satisfied with respect to formal depletion code validation approaches that rely on regression analysis.</p>
<p>The MC USM approach does not require regression analysis, and is not subject to the many assumptions required as part of regression analyses, therefore the MC USM approach can be considered to provide more reliable estimates of bias and bias uncertainty compared to the direct difference approach.</p>
<p>The Kopp 5% approach and EPRI’s implementation of the EPRI depletion benchmark approach are ultimately qualitative methods based on engineering judgment and the analyses performed in this report do not necessarily support use or continued use of these methods. The NRC staff recommends use of one of the formal depletion code validation approaches discussed in this report for use in future licensing applications.</p>
<h2 id="appendix-a-determination-of-9550-tolerance-interval-penalty-factor-to-apply-to-epri-calculated-regression-uncertainty">Appendix A: Determination of 95/50 Tolerance Interval Penalty Factor to Apply to EPRI-Calculated Regression Uncertainty</h2>
<p>To determine a penalty for using a 95/50 regression tolerance interval (more commonly known as a prediction interval) instead of a 95/95 regression tolerance interval, the regression fit uncertainty is increased by an adjustment factor. In this analysis, this factor is based on dividing the regression fit uncertainty by the two-sided tolerance factor that covers 95% of the population 50% of the time and multiplying it by the one-sided tolerance factor that covers 95% of the populations 95% of the time.</p>
<p>First, a function for calculating the one-sided tolerance factor based on the non-central t distribution is defined for use.<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>k1</span> <span class='op'>&lt;-</span>
<span class='kw'>function</span><span class='op'>(</span><span class='va'>samp</span>, <span class='va'>cov</span>, <span class='va'>conf</span><span class='op'>)</span><span class='op'>{</span>
    <span class='va'>n</span> <span class='op'>=</span> <span class='va'>samp</span>                  <span class='co'># number of samples</span>
    <span class='va'>p</span> <span class='op'>=</span> <span class='va'>cov</span>                   <span class='co'># coverage parameter</span>
    <span class='va'>g</span> <span class='op'>=</span> <span class='va'>conf</span>                  <span class='co'># confidence parameter</span>
    <span class='va'>f</span> <span class='op'>=</span> <span class='va'>n</span> <span class='op'>-</span> <span class='fl'>1</span>                 <span class='co'># degrees of freedom</span>
    <span class='va'>delta</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>  <span class='co'># non-centrality parameter</span>
    <span class='va'>k</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/TDist.html'>qt</a></span><span class='op'>(</span><span class='va'>g</span>,<span class='va'>f</span>,<span class='va'>delta</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span> <span class='co'># k-factor for a one-sided tolerance interval</span>
    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>k</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>For regression problems, regression tolerance intervals defined by use of regression tolerance factors are applicable. For regression tolerance factors, an “effective number of observations” must be determined. The effective number of observations can be calculated from the RMSE and the standard error of a given dataset.<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a></p>
<p>The higher burnup data was used to estimate the regression tolerance adjustment factor based on using a 95/50 regression tolerance interval rather than a 95/95 regression tolerance interval. This is for simplicity and conservatism; note that the data is slightly but not much more spread out at these higher burnups when compared to the data at lower burnups.</p>
<p>The higher burnup data was taken to be greater than 45 GWd/MTU and was estimated from Figure 9, “Reactivity Quadratic Regression for Cycle-collapsed Data” from Attachment 2, “EPRI Analysis for Determining the 95/95 Confidence Limits on CASMO Hot Full Power (HFP) Measured Reactivity Decrement Bias Regressions Used in the EPRI/Studsvik Burnup Benchmark” as part of the “Responses to Follow-up RAIs for EPRI Report 1022503 and EPRI Report 1022909” as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>highBUdata</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>750</span>, <span class='fl'>575</span>, <span class='fl'>550</span>, <span class='fl'>510</span>, <span class='fl'>500</span>, <span class='fl'>400</span>, <span class='fl'>375</span>, <span class='fl'>300</span>, <span class='fl'>250</span>, <span class='fl'>250</span>, <span class='fl'>250</span>, <span class='fl'>220</span>,
                <span class='fl'>210</span>, <span class='fl'>125</span>, <span class='fl'>115</span>, <span class='op'>-</span><span class='fl'>115</span>, <span class='op'>-</span><span class='fl'>115</span>, <span class='op'>-</span><span class='fl'>500</span><span class='op'>)</span>
<span class='va'>highBUdata</span>
</code></pre>
</div>
</details>
<pre><code> [1]  750  575  550  510  500  400  375  300  250  250  250  220  210
[14]  125  115 -115 -115 -500</code></pre>
</div>
<p>The effective number of observations is calculated by dividing the RMSE of the data by the standard error of the data as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># The root mean square error is estimated to be:</span>

<span class='va'>RMSE</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/hydroGOF/man/rmse.html'>rmse</a></span><span class='op'>(</span>sim<span class='op'>=</span><span class='va'>highBUdata</span>, obs<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>highBUdata</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> 
<span class='co'># Note: 0 is used as the reference.</span>
<span class='va'>RMSE</span>
</code></pre>
</div>
<pre><code>[1] 385.98</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># The standard error is estimated to be:</span>

<span class='va'>stdErr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>highBUdata</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>highBUdata</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>stdErr</span>
</code></pre>
</div>
<pre><code>[1] 69.55508</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Therefore, the effective number of observations is:</span>

<span class='va'>nEff</span> <span class='op'>&lt;-</span>  <span class='va'>RMSE</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>/</span><span class='va'>stdErr</span><span class='op'>^</span><span class='fl'>2</span>
<span class='va'>nEff</span>
</code></pre>
</div>
<pre><code>[1] 30.79441</code></pre>
</div>
<p>To determine the penalty for using a 95/50 regression tolerance interval instead of a 95/95 regression tolerance interval, the regression fit uncertainty is then increased by an adjustment factor. This factor is based on dividing the regression fit uncertainty by the two-sided tolerance factor that covers 95% of the population 50% of the time and multiplying it by the one-sided tolerance factor that covers 95% of the population 95% of the time. Note that it was assumed that EPRI calculated a two-sided prediction interval rather than two one-sided intervals. The calculation was performed as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>adjFactor</span> <span class='op'>&lt;-</span> <span class='fu'>k1</span><span class='op'>(</span><span class='va'>nEff</span>,<span class='fl'>0.95</span>,<span class='fl'>0.95</span><span class='op'>)</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/pkg/tolerance/man/Kfactor.html'>K.factor</a></span><span class='op'>(</span>
                                    n<span class='op'>=</span><span class='va'>nEff</span>, 
                                    f<span class='op'>=</span><span class='va'>nEff</span><span class='op'>-</span><span class='fl'>1</span>, 
                                    alpha<span class='op'>=</span><span class='fl'>1</span><span class='op'>-</span><span class='fl'>0.50</span>,
                                    P<span class='op'>=</span><span class='fl'>0.95</span>,
                                    side<span class='op'>=</span><span class='fl'>2</span>,
                                    method<span class='op'>=</span><span class='st'>"EXACT"</span>, m<span class='op'>=</span><span class='fl'>100</span>
                                  <span class='op'>)</span>

<span class='va'>adjFactor</span>
</code></pre>
</div>
<pre><code>[1] 1.098272</code></pre>
</div>
<p>EPRI has previously calculated other uncertainty data that factors into the final 95/95 depletion uncertainty determination. This data, taken from the EPRI benchmark report, is as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>EPRIuncData</span> <span class='op'>&lt;-</span> <span class='fu'>tbl_df</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"data/EPRIuncData.csv"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='va'>EPRIuncData</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">burnup</th>
<th style="text-align: right;">HtoC</th>
<th style="text-align: right;">fTemp</th>
<th style="text-align: right;">regUncLow</th>
<th style="text-align: right;">regUncHigh</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">380</td>
<td style="text-align: right;">255</td>
<td style="text-align: right;">250</td>
<td style="text-align: right;">333</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td style="text-align: right;">452</td>
<td style="text-align: right;">255</td>
<td style="text-align: right;">500</td>
<td style="text-align: right;">667</td>
</tr>
<tr class="odd">
<td style="text-align: right;">30</td>
<td style="text-align: right;">446</td>
<td style="text-align: right;">255</td>
<td style="text-align: right;">750</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="even">
<td style="text-align: right;">40</td>
<td style="text-align: right;">430</td>
<td style="text-align: right;">255</td>
<td style="text-align: right;">800</td>
<td style="text-align: right;">1167</td>
</tr>
<tr class="odd">
<td style="text-align: right;">50</td>
<td style="text-align: right;">410</td>
<td style="text-align: right;">255</td>
<td style="text-align: right;">900</td>
<td style="text-align: right;">1300</td>
</tr>
<tr class="even">
<td style="text-align: right;">60</td>
<td style="text-align: right;">398</td>
<td style="text-align: right;">255</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">1400</td>
</tr>
</tbody>
</table>
</div>
<p>The <code>burnup</code> column is the burnup in GWd/MTU, “HtoC” is the 2-sigma hot-to-cold cross-section uncertainty, <code>fTemp</code> is the 2-sigma fuel temperature uncertainty as applied to the cold SFP environment, and <code>regUncLow</code> and <code>regUncHigh</code> are lower and upper prediction intervals, respectively, as estimated from Figure 9 of Attachment 2; the 95/50 penalty factor applies only to this regression uncertainty. Note that the upper prediction interval is being adjusted as it is larger than the lower prediction interval producing a more conservative uncertainty estimate. This was done because EPRI does not indicate whether positive reactivity decrement error means depletion code under- or over-prediction. Therefore, the most appropriate prediction interval could not be determined without additional information. The prediction interval corresponding to depletion code under-prediction should be used.</p>
<p>Technically, whether the depletion code under- or over-predicts on average is also important to determine whether or not a depletion code bias should be applied based on the regression analysis. EPRI notes that “the maximum width of the 95% confidence interval in Figure 9 [of Attachment 2] is 174 pcm at the high burnup end of the regression.” This would be interpreted to mean that at the high burnup end of the regression curve, that the depletion code could be in error by up to 174 pcm on average. If this corresponds to an average underprediction of 174 pcm, it is generally expected that this bias be accounted for; alternatively, a burnup-dependent bias would be justified. At the same time, it would also be reasonable to discount this underprediction from the width of the 95/95 tolerance interval when determining the 95/95 regression uncertainty; likewise, it would also be reasonable to discount any overprediction from the width of the 95/95 tolerance interval while not crediting the overprediction bias. This was also the approach taken when analyzing the NUREG/CR-7108 direct difference data in this report. For the purposes of the NRC-adjusted EPRI validation approach, no bias was accounted for, which is estimated to have a relatively small but not insignificant effect.</p>
<p>The adjusted uncertainty then becomes:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>EPRIuncDataAdj</span> <span class='op'>&lt;-</span> <span class='va'>EPRIuncData</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>regUnc<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>regUncHigh</span> <span class='op'>*</span> <span class='va'>adjFactor</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='va'>EPRIuncDataAdj</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">burnup</th>
<th style="text-align: right;">HtoC</th>
<th style="text-align: right;">fTemp</th>
<th style="text-align: right;">regUncLow</th>
<th style="text-align: right;">regUncHigh</th>
<th style="text-align: right;">regUnc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">380</td>
<td style="text-align: right;">255</td>
<td style="text-align: right;">250</td>
<td style="text-align: right;">333</td>
<td style="text-align: right;">366</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td style="text-align: right;">452</td>
<td style="text-align: right;">255</td>
<td style="text-align: right;">500</td>
<td style="text-align: right;">667</td>
<td style="text-align: right;">733</td>
</tr>
<tr class="odd">
<td style="text-align: right;">30</td>
<td style="text-align: right;">446</td>
<td style="text-align: right;">255</td>
<td style="text-align: right;">750</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">1098</td>
</tr>
<tr class="even">
<td style="text-align: right;">40</td>
<td style="text-align: right;">430</td>
<td style="text-align: right;">255</td>
<td style="text-align: right;">800</td>
<td style="text-align: right;">1167</td>
<td style="text-align: right;">1282</td>
</tr>
<tr class="odd">
<td style="text-align: right;">50</td>
<td style="text-align: right;">410</td>
<td style="text-align: right;">255</td>
<td style="text-align: right;">900</td>
<td style="text-align: right;">1300</td>
<td style="text-align: right;">1428</td>
</tr>
<tr class="even">
<td style="text-align: right;">60</td>
<td style="text-align: right;">398</td>
<td style="text-align: right;">255</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">1400</td>
<td style="text-align: right;">1538</td>
</tr>
</tbody>
</table>
</div>
<p>Combining the uncertainties by the root sum of squares (RSS) and adding depletion code specific biases in the SFP environment, as was previously determined by EPRI in the EPRI utilization report, the following final 95/95 determination based on the combination of code-specific biases and uncertainties is determined:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>EPRIadj</span> <span class='op'>&lt;-</span> 
    <span class='va'>EPRIuncDataAdj</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>RSS<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>HtoC</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>+</span><span class='va'>fTemp</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>+</span><span class='va'>regUnc</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>utilBias<span class='op'>=</span><span class='fl'>150</span><span class='op'>+</span><span class='op'>(</span><span class='fl'>643</span><span class='op'>-</span><span class='fl'>576</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>BandU<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>RSS</span><span class='op'>+</span><span class='va'>utilBias</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='va'>EPRIadj</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">burnup</th>
<th style="text-align: right;">HtoC</th>
<th style="text-align: right;">fTemp</th>
<th style="text-align: right;">regUncLow</th>
<th style="text-align: right;">regUncHigh</th>
<th style="text-align: right;">regUnc</th>
<th style="text-align: right;">RSS</th>
<th style="text-align: right;">utilBias</th>
<th style="text-align: right;">BandU</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">380</td>
<td style="text-align: right;">255</td>
<td style="text-align: right;">250</td>
<td style="text-align: right;">333</td>
<td style="text-align: right;">366</td>
<td style="text-align: right;">586</td>
<td style="text-align: right;">217</td>
<td style="text-align: right;">803</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td style="text-align: right;">452</td>
<td style="text-align: right;">255</td>
<td style="text-align: right;">500</td>
<td style="text-align: right;">667</td>
<td style="text-align: right;">733</td>
<td style="text-align: right;">898</td>
<td style="text-align: right;">217</td>
<td style="text-align: right;">1115</td>
</tr>
<tr class="odd">
<td style="text-align: right;">30</td>
<td style="text-align: right;">446</td>
<td style="text-align: right;">255</td>
<td style="text-align: right;">750</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">1098</td>
<td style="text-align: right;">1212</td>
<td style="text-align: right;">217</td>
<td style="text-align: right;">1429</td>
</tr>
<tr class="even">
<td style="text-align: right;">40</td>
<td style="text-align: right;">430</td>
<td style="text-align: right;">255</td>
<td style="text-align: right;">800</td>
<td style="text-align: right;">1167</td>
<td style="text-align: right;">1282</td>
<td style="text-align: right;">1376</td>
<td style="text-align: right;">217</td>
<td style="text-align: right;">1593</td>
</tr>
<tr class="odd">
<td style="text-align: right;">50</td>
<td style="text-align: right;">410</td>
<td style="text-align: right;">255</td>
<td style="text-align: right;">900</td>
<td style="text-align: right;">1300</td>
<td style="text-align: right;">1428</td>
<td style="text-align: right;">1507</td>
<td style="text-align: right;">217</td>
<td style="text-align: right;">1724</td>
</tr>
<tr class="even">
<td style="text-align: right;">60</td>
<td style="text-align: right;">398</td>
<td style="text-align: right;">255</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">1400</td>
<td style="text-align: right;">1538</td>
<td style="text-align: right;">1609</td>
<td style="text-align: right;">217</td>
<td style="text-align: right;">1826</td>
</tr>
</tbody>
</table>
</div>
<p>The <code>RSS</code> column is the RSS of the uncertainty data, the <code>utilBias</code> is the bias from the EPRI utilization report, and <code>BandU</code> is the sum of the <code>RSS</code> and <code>utilBias</code> columns. The <code>BandU</code> column corresponds to the <code>EPRIstat</code> labels in the report figures.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-ans827" class="csl-entry" role="doc-biblioentry">
ANS. 2015. <span>“ANSI/ANS-8.27-2015, Burnup Credit for LWR Fuel.”</span> American Nuclear Society.
</div>
<div id="ref-epriRESPc2016" class="csl-entry" role="doc-biblioentry">
Cummings, Kristopher. 2016. <span>“Response to Request for Additional Information (RAI) Questions Regarding EPRI Report 1025203, ’Utilization of the EPRI Depletion Benchmarks for Burnup Credit Validation,’ and EPRI Report 1022909, ’Benchmarks for Quantifying Fuel Reactivity Depletion Uncertainty’.”</span> Letter. <a href="http://www.nrc.gov/docs/ML1610/ML16104A332.html">http://www.nrc.gov/docs/ML1610/ML16104A332.html</a>.
</div>
<div id="ref-gauld2003strategies" class="csl-entry" role="doc-biblioentry">
Gauld, IC. 2003. <span>“Strategies for Application of Isotopic Uncertainties in Burnup Credit.”</span> <em>ORNL/TM-2001/257, Oak Ridge National Laboratory</em>. <a href="http://wp.ornl.gov/ webworks/cppr/y2003/rpt/112517.pdf">http://wp.ornl.gov/ webworks/cppr/y2003/rpt/112517.pdf</a>.
</div>
<div id="ref-epriTOPb2012" class="csl-entry" role="doc-biblioentry">
Lancaster, Dale. 2012. <span>“Utilization of the EPRI Depletion Benchmarks for Burnup Credit Validation.”</span> Report. Electric Power Research Institute, Palo Alto, CA. <a href="http://www.epri.com/abstracts/Pages/ProductAbstract.aspx?ProductId=000000000001025203">http://www.epri.com/abstracts/Pages/ProductAbstract.aspx?ProductId=000000000001025203</a>.
</div>
<div id="ref-myhre2010tolerance" class="csl-entry" role="doc-biblioentry">
Myhre, Janet, Daniel R Jeske, Michael Rennie, and Yingtao Bi. 2010. <span>“Tolerance Intervals in a Heteroscedastic Linear Regression Context with Applications to Aerospace Equipment Surveillance.”</span> <em>International Journal of Quality, Statistics, and Reliability</em> 2009. <a href="https://doi.org/10.1155/2009/126283">https://doi.org/10.1155/2009/126283</a>.
</div>
<div id="ref-natrella2013nist" class="csl-entry" role="doc-biblioentry">
Natrella, Mary. 2013. <em>NIST/SEMATECH e-Handbook of Statistical Methods</em>. NIST/SEMATECH. <a href="http://www.itl.nist.gov/div898/handbook/prc/section2/prc263.htm">http://www.itl.nist.gov/div898/handbook/prc/section2/prc263.htm</a>.
</div>
<div id="ref-scale61" class="csl-entry" role="doc-biblioentry">
ORNL. 2011. <span>“SCALE: A Comprehensive Modeling and Simulation Suite for Nuclear Safety Analysis and Design.”</span> Computer Program. ORNL.
</div>
<div id="ref-Rpackage" class="csl-entry" role="doc-biblioentry">
R Core Team. 2015. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-cr7108" class="csl-entry" role="doc-biblioentry">
Radulescu, G, I. C. Gauld, G. Ilas, and J. C. Wagner. 2012. <span>“An Approach for Validating Actinide and Fission Product Burnup Credit Criticality Safety Analyses - Isotopic Composition Predictions.”</span> Report. ORNL. <a href="http://www.nrc.gov/docs/ML1211/ML12116A124.pdf">http://www.nrc.gov/docs/ML1211/ML12116A124.pdf</a>.
</div>
<div id="ref-shalizi2013advanced" class="csl-entry" role="doc-biblioentry">
Shalizi, Cosma Rohilla. 2016. <span>“Advanced Data Analysis from an Elementary Point of View.”</span> <a href="http://www.stat.cmu.edu/ cshalizi/ADAfaEPoV">http://www.stat.cmu.edu/ cshalizi/ADAfaEPoV</a>.
</div>
<div id="ref-epriTOPa2011" class="csl-entry" role="doc-biblioentry">
Smith, K., S. Tarves, T. Bahadir, and R. Ferrer. 2011. <span>“Benchmarks for Quantifying Fuel Reactivity Depletion Uncertainty.”</span> Report. Electric Power Research Institute, Palo Alto, CA. <a href="http://www.epri.com/abstracts/Pages/ProductAbstract.aspx?ProductId=000000000001022909">http://www.epri.com/abstracts/Pages/ProductAbstract.aspx?ProductId=000000000001022909</a>.
</div>
<div id="ref-wallis1951tolerance" class="csl-entry" role="doc-biblioentry">
Wallis, W. Allen. 1951. <span>“Tolerance Intervals for Linear Regression.”</span> <a href="http://digitalassets.lib.berkeley.edu/math/ucb/text/math_s2_article-04.pdf">http://digitalassets.lib.berkeley.edu/math/ucb/text/math_s2_article-04.pdf</a>.
</div>
<div id="ref-wikiTol" class="csl-entry" role="doc-biblioentry">
Wikipedia. 2016. <span>“Tolerance Interval — Wikipedia<span>,</span> the Free Encyclopedia.”</span> <a href="https://en.wikipedia.org/w/index.php?title=Tolerance_interval&amp;oldid=720051009">https://en.wikipedia.org/w/index.php?title=Tolerance_interval&amp;oldid=720051009</a>.
</div>
<div id="ref-tolPackageR" class="csl-entry" role="doc-biblioentry">
Young, Derek S. 2010. <span>“<span class="nocase">tolerance</span>: An <span>R</span> Package for Estimating Tolerance Intervals.”</span> <em>Journal of Statistical Software</em> 36 (5): 1–39. <a href="http://www.jstatsoft.org/v36/i05/">http://www.jstatsoft.org/v36/i05/</a>.
</div>
</div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>These nuclides represent the overwhelming majority of fuel reactivity independent of burnup.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>The NEWT 2-D deterministic neutron flux solver was used for transport calculations.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>See data error bars in NUREG/CR-7108 Figure 6.1, “Measured-to-calculated concentration ratio versus fuel sample burnup for (a) U-235; (b) Pu-239. The error bars in the graph represent the reported 1-sigma measurement errors; very small measurement errors (0.1%) are not visible on the graph.”<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p>This is likely also the case with the noisy NUREG/CR-7108 measurement data. However, no attempt was made to distinguish measurement uncertainty from true depletion uncertainty (i.e. the noise from the signal). One possible technique is the removal of data with measurement uncertainties known to be prohibitively large, or suspected with high confidence to be, prohibitively large. However, this introduces a qualitative aspect to the analysis and extreme caution would need to be used.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5" role="doc-endnote"><p>In this analysis, TRITON calls the CSAS5 sequence, which uses KENO-V.a as the three-dimensional stochastic neutron flux solver for transport calculations.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6" role="doc-endnote"><p>The reason two-sided factors are used in this analysis is because both the direct difference and EPRI dataset prediction intervals were calculated as two-sided intervals. The two-sided tolerance factors were determined using the <code>K.factor</code> function in the R <code>tolerance</code> package.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7" role="doc-endnote"><p>See discussion “tolerance: An R Package for Estimating Tolerance Intervals,” Journal of Statistical Software, August 2010, Volume 36, Issue 5, Section 5.1, “Linear regression tolerance intervals.”<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8" role="doc-endnote"><p>See entire discussion in Chapter 7, “Moving Beyond Conditional Expectations: Weighted Least Squares, Heteroskedasticity, Local Polynomial Regression,” for more on the reasoning behind choosing a WLS model and the various assumptions used in this analysis.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9" role="doc-endnote"><p>The Kopp 5% tolerance interval shown is based on a ordinary linear least-squares (OLS) regression model rather than a WLS model. This assumes equal variance weights as a function of burnup (i.e that the data is homoskedastic).<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10" role="doc-endnote"><p>See Section 4, “Criteria to establish subcriticality.”<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11" role="doc-endnote"><p>It is important to keep in mind that the 95/95 uncertainty derived from the tolerance interval corresponding to the Kopp 5% approach in this analysis is <em>not</em> being used in this comparison.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12" role="doc-endnote"><p>Source: <a href="http://www.itl.nist.gov/div898/handbook/prc/section2/prc263.r">http://www.itl.nist.gov/div898/handbook/prc/section2/prc263.r</a>; Discussion: <a href="http://www.itl.nist.gov/div898/handbook/prc/section2/prc263.htm">http://www.itl.nist.gov/div898/handbook/prc/section2/prc263.htm</a><a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13" role="doc-endnote"><p>From “tolerance: An R Package for Estimating Tolerance Intervals,” Journal of Statistical Software, August 2010, Volume 36, Issue 5 Article available at: <a href="https://www.jstatsoft.org/article/view/v036i05/v36i05.pdf">https://www.jstatsoft.org/article/view/v036i05/v36i05.pdf</a><a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="updates-and-corrections">Corrections</h3>
  <p>If you see mistakes or want to suggest changes, please <a href="https://github.com/AmritPatel/existentially-technology/issues/new">create an issue</a> on the source repository.</p>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Source code is available at <a href="https://github.com/AmritPatel/existentially-technology/">https://github.com/AmritPatel/existentially-technology/</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Patel (2016, June 9). Existentially, technology: Comparison of Pressurized Water Reactor Depletion Code Validation Approaches. Retrieved from https://existentially-tech.netlify.app/papers/2016-06-09-depletion-uncertainty-meta-analysis/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{patel2016comparison,
  author = {Patel, Amrit},
  title = {Existentially, technology: Comparison of Pressurized Water Reactor Depletion Code Validation Approaches},
  url = {https://existentially-tech.netlify.app/papers/2016-06-09-depletion-uncertainty-meta-analysis/},
  year = {2016}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="distill-site-nav distill-site-footer">
  <p>Created and maintained by <a href="https://github.com/AmritPatel/existentially-technology">Amrit Patel</a>.</p>
  <p>This work is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>
